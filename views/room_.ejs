<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>

<body>
    <h1>
        <%= room.PIN%>
    </h1>
    <ul id="guests"></ul>



</body>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
    //    var socket = io({transports: ['websocket'], upgrade: false});
    const socket = io();
    let boolean = false;
    socket.on('connect', () => {
        <% if(user) {%>
        boolean = true;
        <% } %>

        console.log(socket.id); // true
        socket.emit('room', <%= room.PIN %>, boolean);
    });


    socket.on('join_room', (nroom) => {
        console.log(nroom)
        //Swiezo dodany nick jest pokazany po odswiezeniu
        document.getElementById('guests').innerHTML = "";
        nroom.forEach(function(guest) {
            socket.emit('findG', guest, socket.id);
            socket.on(guest, (foundG) => {
                console.log(2)
                $('#guests').append($('<li>').text(foundG.username));
                console.log(foundG);
                console.log("xd");

            })
        })

    })

</script>

</html>
